<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta content="text/html" charset="UTF-8">
    <title th:text="*{title}"></title>

    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.1/css/bootstrap.min.css} "/>
    <link th:rel="stylesheet" th:href="@{/css/homepage.css}">
</head>

<body class="text-center">

<!-- Main Container -->
<main class="form-generate">
    <form action="">
        <img class="mb-3" th:src="@{/img/logo_round-128x128.png}" alt="dotspace Logo">
        <h1 class="h3 mb-5 fw-normal">URL-Minifier</h1>
        <h1 class="h6 mt-5 mb-2">Insert URL here</h1>
        <!-- User Input -->
        <div class="form-floating mb-3">
            <input type="url" class="form-control" id="floatingInput" placeholder="https://www.youtube.com/watch?v=dQw4w9WgXcQ">
            <label for="floatingInput">URL</label>
        </div>
        <!-- End User Input -->
        <button class="w-100 btn btn-lg btn-primary" id="submitBtn" type="button">Generate</button>
        <p class="mt-5 mb-3 text-muted">Made with ❤ by <a href="https://github.com/Likqez">Lukas Lanzner</a></p>
        <p class="text-muted">© 2022</p>
    </form>
</main>
<!-- End Main Container -->


<div th:replace="fragments/fragments.html :: modal"></div>


<script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/2.9.3/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/5.1.1/js/bootstrap.min.js}"></script>

<script>
    $(document).ready(function () {
        $("#submitBtn").click(function (e) {
            e.preventDefault();
            $.ajax({
                type: "POST",
                url: "/api/v1/create",
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: JSON.stringify({url: $("#floatingInput").val()}),
                success: function (data) {
                    jQuery('#outputUrl').val(data.url);
                    jQuery('#outputImage').attr('src','data:image/png;base64,' + data.image);
                    jQuery('#floatingInput').val('');
                    jQuery('#responseModal').modal('show');
                }
            });

        });
    });
</script>

</body>
</html>
